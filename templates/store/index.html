{% extends 'base.html' %}
{% load static %}
{% load url_param_replace %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/product_list.css' %}"/>
{% endblock %}

{% block content %}
    <div>
        <div class='search_div'>
            <form id='search' action="">
                <label for='searchline' hidden></label>
                {{ filter.form.name }}
                <button class="main-search"></button>
            </form>
        </div>
    </div>
    <div class="container">
        <div class="body_outer">
            <div class="left_panel">
                <form method="get">
{#                    {{ filter.form.price.label_tag }}#}
{#                    {{ filter.form.price }}#}
                    {{ filter.form.category.label_tag }}
                    {{ filter.form.category }}
                    <br>
                    {% if filter.form.vendor.field.choices %}
                        {{ filter.form.vendor.label_tag }}
                        {{ filter.form.vendor }}
                    {% endif %}
                    <input type="submit" class="btn btn-primary"/>
                </form>
            </div>
            <div class="right_panel">
                <ul class="sort_list">
                    <li>
                        <p class="sort_title">Отсортировать: </p>
                    </li>
                    <li class="dropdown">
                        {% if filter.form.sort.value %}
                            {% for value, label in filter.form.sort.field.choices %}
                                {% if value in filter.form.sort.value %}
                                    <a class="sort_link dropdown-toggle" href="#"
                                       data-bs-toggle="dropdown">{{ label }}</a>
                                {% endif %}
                            {% endfor %}
                        {% else %}
                        <a class="sort_link dropdown-toggle" href="#"
                           data-bs-toggle="dropdown">все</a>
                        {% endif %}
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a class="dropdown-item" href="?{% url_param_replace sort='price' %}">от дешевых к дорогим</a></li>
                            <li><a class="dropdown-item" href="?{% url_param_replace sort='-price' %}">от дорогих к дешевым</a></li>
                            <li><a class="dropdown-item" href="?{% url_param_replace sort='name' %}">по алфавиту</a></li>
                            <li><a class="dropdown-item" href="?{% url_param_replace sort='date_created' %}">новинки</a></li>
                        </ul>
                    </li>
                </ul>
                <div class="pagination">
                    <span class="step-links">
                        {% if page_obj.has_previous %}
                            <a href="?{% url_param_replace page=1 %}">&laquo; first</a>
                            <a href="?{% url_param_replace page=page_obj.previous_page_number %}">previous</a>
                        {% endif %}
                        <span class="current">
                            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                        </span>
                        {% if page_obj.has_next %}
                            <a href="?{% url_param_replace page=page_obj.next_page_number %}">next</a>
                            <a href="?{% url_param_replace page=page_obj.paginator.num_pages %}">last &raquo;</a>
                        {% endif %}
                    </span>
                </div>
                <div class="main_products">
                    {% for product in products %}
                        <div>
                            <a href="{% url 'product-detail' pk=product.id %}">
                                <img class="card_img"
                                     src='{% get_media_prefix %}{{ product.image }}'
                                     alt=""/>
                                <p>{{ product.name }}</p>
                            </a>
                            <div class="inner_card">
                                <div class="price_comb">
                                    <h6>цена</h6>
                                    <h5>{{ product.price }} ₴</h5>
                                </div>
                                <div class="card_buttons">
                                    <a class='details_btn' href="{% url 'product-detail' pk=product.id %}">Детали</a>
                                    <a class='add_to_cart_btn' href="#">В корзину</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
